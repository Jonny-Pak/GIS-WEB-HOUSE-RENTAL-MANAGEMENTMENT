{% extends 'quanly/layouts/base.html' %}
{% load static %}

{% block title %}Chi tiết - Biệt thự Thảo Điền{% endblock %}

{% block content %}

<div class="hero page-inner overlay"
    style="background-image: url('{% static \'images/hero_bg_3.jpg\' %}'); height: 40vh; min-height: 300px;">
    <div class="container">
        <div class="row justify-content-center align-items-center" style="height: 40vh; min-height: 300px;">
            <div class="col-lg-9 text-center mt-5">
                <h1 class="heading" data-aos="fade-up">{{ house.name }}</h1>
                <nav aria-label="breadcrumb" data-aos="fade-up" data-aos-delay="200">
                    <ol class="breadcrumb text-center justify-content-center">
                        <li class="breadcrumb-item"><a href="{% url 'home' %}">Trang chủ</a></li>
                        <li class="breadcrumb-item"><a href="#">TP. Thủ Đức</a></li>
                        <li class="breadcrumb-item active text-white-50" aria-current="page">Chi tiết</li>
                    </ol>
                </nav>
            </div>
        </div>
    </div>
</div>

<div class="section">
    <div class="container">
        <div class="row justify-content-between">

            <div class="col-lg-8">

                <div class="img-property-main mb-4">
                    <img src="{% static 'images/img_3.jpg' %}" alt="Image" class="img-fluid rounded w-100"
                        style="height: 500px; object-fit: cover;">
                </div>

                <div class="row mb-5">
                    {% for img in house.images.all %}
                    <div class="col-4 mb-3">
                        <img src="{{ img.image.url }}" alt="Image" class="img-fluid rounded"
                            style="height: 120px; width: 100%; object-fit: cover; cursor: pointer;">
                    </div>
                    {% empty %}
                    <div class="col-12 text-muted fst-italic">Chưa có ảnh mô tả cho ngôi nhà này.</div>
                    {% endfor %}
                </div>

                <h2 class="heading text-primary">Thông tin chi tiết</h2>
                <p class="text-black-50"><span class="icon-map-marker me-1"></span> {{ house.address }}, {{
                    house.get_district_display }}</p>

                <div class="row mt-4 mb-4">
                    <div class="col-md-6 col-lg-4 mb-3">
                        <div class="d-flex align-items-center">
                            <span class="flaticon-house-1 me-2 text-primary display-6"></span>
                            <div>
                                <span class="d-block fw-bold">Diện tích</span>
                                <span class="text-black-50">{{ house.area }} m²</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-4 mb-3">
                        <div class="d-flex align-items-center">
                            <span class="flaticon-building me-2 text-primary display-6"></span>
                            <div>
                                <span class="d-block fw-bold">Loại hình</span>
                                <span class="text-black-50">{{ house.get_house_type_display }}</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-4 mb-3">
                        <div class="d-flex align-items-center">
                            <span class="icon-users me-2 text-primary display-6"></span>
                            <div>
                                <span class="d-block fw-bold">Số người tối đa</span>
                                <span class="text-black-50">{% if house.max_people %}{{ house.max_people }} người{% else
                                    %}Không giới hạn{% endif %}</span>
                            </div>
                        </div>
                    </div>
                </div>

                <hr>

                <h3 class="heading text-primary mt-4">Mô tả</h3>
                <p>{{ house.description|linebreaks }}</p>

                <h3 class="heading text-primary mt-4">Nội thất (Đã trang bị)</h3>
                <div class="row">
                    <div class="col-md-12 mb-3">
                        <div class="p-3 border rounded bg-light h-100">
                            <ul class="list-unstyled mb-0">
                                {% for fur in house.furniture.all %}
                                <li class="mb-2"><span class="icon-check text-success me-2"></span> {{ fur.name }}</li>
                                {% empty %}
                                <li class="text-muted">Chưa có thông tin nội thất.</li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                </div>

                <h3 class="heading text-primary mt-5">Vị trí trên bản đồ</h3>
                <div class="bg-light rounded d-flex align-items-center justify-content-center position-relative shadow-sm"
                    style="height: 400px; border: 2px dashed #ccc; background-image: url('{% static \'images/map_placeholder.jpg\' %}'); background-size: cover;">
                    <div class="text-center p-4 bg-white rounded shadow-sm opacity-75">
                        <span class="icon-map-marker display-4 text-danger"></span>
                        <p class="mt-2 text-black fw-bold mb-0">Bản đồ GIS</p>
                        <small>Lat: {{ house.lat|default:"Đang cập nhật" }} | Long: {{ house.lng|default:"Đang cập nhật"
                            }}</small>
                    </div>
                </div>

            </div>

            <div class="col-lg-4">

                <div class="bg-white widget border rounded p-4 mb-4 shadow-sm sticky-top"
                    style="top: 20px; z-index: 10;">
                    <h3 class="h4 text-black widget-title mb-3">Giá thuê</h3>
                    <div class="price mb-3">
                        <span class="text-primary h2 fw-bold">{% if house.price %}{{ house.price|floatformat:0 }} VNĐ{%
                            else %}Thỏa thuận{% endif %}</span>
                        <span class="text-muted">/tháng</span>
                    </div>
                    <div class="mb-3">
                        <span class="badge bg-warning text-dark px-3 py-2">Cọc: {% if house.deposit %}{{
                            house.deposit|floatformat:0 }} VNĐ{% else %}0 VNĐ{% endif %}</span>
                    </div>

                    <form action="#" class="form-contact-agent">
                        <div class="form-group mb-3">
                            <button type="button" class="btn btn-primary w-100 py-3 fw-bold shadow-sm">
                                <span class="icon-phone me-2"></span> {{ house.owner_phone }}
                            </button>
                        </div>
                    </form>
                </div>

                <div class="bg-white widget border rounded p-4 shadow-sm mt-4">
                    <h3 class="h4 text-black widget-title mb-3">Người đăng tin</h3>
                    <div class="d-flex align-items-center mb-4">
                        <img src="{% static 'images/person_1-min.jpg' %}" alt="Image"
                            class="img-fluid rounded-circle me-3" style="width: 60px; height: 60px; object-fit: cover;">
                        <div>
                            <h5 class="mb-0 text-black fw-bold">{% if house.owner %}{{ house.owner.username }}{% else
                                %}Ẩn danh{% endif %}</h5>
                            <span class="text-muted small">Chủ nhà</span>
                        </div>
                    </div>
                    <p class="text-muted small fst-italic">"Tôi luôn hỗ trợ khách hàng xem nhà 24/7. Vui lòng liên hệ
                        trước khi đến."</p>
                </div>

                <div class="bg-white widget border rounded p-4 mt-4 shadow-sm">
                    <h3 class="h4 text-black widget-title mb-3">Tìm kiếm khác</h3>
                    <ul class="list-unstyled links">
                        <li><a href="#">Nhà thuê Quận 1 <span class="text-muted">(12)</span></a></li>
                        <li><a href="#">Nhà thuê Quận 3 <span class="text-muted">(5)</span></a></li>
                        <li><a href="#">Căn hộ Bình Thạnh <span class="text-muted">(8)</span></a></li>
                    </ul>
                </div>

            </div>
        </div>
    </div>
</div>

<div class="section">
    <div class="container">
        <div class="row mb-5 align-items-center">
            <div class="col-lg-6">
                <h2 class="font-weight-bold text-primary heading">Nhà tương tự</h2>
            </div>
            <div class="col-lg-6 text-lg-end">
                <a href="{% url 'home' %}" class="btn btn-primary text-white py-3 px-4">Xem thêm</a>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6 col-lg-4 mb-4">
                <div class="property-item">
                    <a href="#" class="img">
                        <img src="{% static 'images/img_2.jpg' %}" alt="Image" class="img-fluid" />
                    </a>
                    <div class="property-content">
                        <div class="price mb-2"><span>8,500,000 VNĐ</span></div>
                        <div>
                            <span class="d-block mb-2 text-black-50">123 Lê Lợi</span>
                            <span class="city d-block mb-3">Quận 1, TP.HCM</span>
                            <div class="specs d-flex mb-4">
                                <span class="d-block d-flex align-items-center me-3">
                                    <span class="flaticon-house-1 me-2"></span><span class="caption">45m²</span>
                                </span>
                                <span class="d-block d-flex align-items-center">
                                    <span class="icon-users me-2"></span><span class="caption">2 người</span>
                                </span>
                            </div>
                            <a href="#" class="btn btn-primary py-2 px-3">Chi tiết</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-4 mb-4">
                <div class="property-item">
                    <a href="#" class="img">
                        <img src="{% static 'images/img_4.jpg' %}" alt="Image" class="img-fluid" />
                    </a>
                    <div class="property-content">
                        <div class="price mb-2"><span>5,000,000 VNĐ</span></div>
                        <div>
                            <span class="d-block mb-2 text-black-50">Chung cư Mini</span>
                            <span class="city d-block mb-3">Bình Thạnh, TP.HCM</span>
                            <div class="specs d-flex mb-4">
                                <span class="d-block d-flex align-items-center me-3">
                                    <span class="flaticon-house-1 me-2"></span><span class="caption">25m²</span>
                                </span>
                                <span class="d-block d-flex align-items-center">
                                    <span class="icon-users me-2"></span><span class="caption">2 người</span>
                                </span>
                            </div>
                            <a href="#" class="btn btn-primary py-2 px-3">Chi tiết</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-4 mb-4">
                <div class="property-item">
                    <a href="#" class="img">
                        <img src="{% static 'images/img_5.jpg' %}" alt="Image" class="img-fluid" />
                    </a>
                    <div class="property-content">
                        <div class="price mb-2"><span>15,000,000 VNĐ</span></div>
                        <div>
                            <span class="d-block mb-2 text-black-50">Nhà phố mặt tiền</span>
                            <span class="city d-block mb-3">Gò Vấp, TP.HCM</span>
                            <div class="specs d-flex mb-4">
                                <span class="d-block d-flex align-items-center me-3">
                                    <span class="flaticon-house-1 me-2"></span><span class="caption">80m²</span>
                                </span>
                                <span class="d-block d-flex align-items-center">
                                    <span class="icon-users me-2"></span><span class="caption">5 người</span>
                                </span>
                            </div>
                            <a href="#" class="btn btn-primary py-2 px-3">Chi tiết</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}